//A recursive file loader
var fs = require('fs'),
	path = require('path');
	
var join = path.join;

//If details set to true, details of each file loading will be logged
var fileLoader = function(filePath, details) {
	var log = function(str) {
		if(details) {
			console.log(str);
		}
	};
	log('Loading modules...\n');
	var modules = {};
	fs.readdirSync(filePath).forEach(function(file) {
		if(fs.lstatSync(join(filePath,file)).isDirectory()) {
			log('Loading directory \'' + file + '\'');
			modules[file] = {};
			modules[file] = fileLoader(join(filePath,file));
		} else {
			log('Loading file \'' + file + '\'');
			var fileName = path.basename(file, '.js');
			modules[fileName] = {};
			modules[fileName] = require(join(filePath,file));
		}
	});
	log('Done\n');
	return modules;
}

module.exports = fileLoader;